import {地支} from "../interfaces/地支";

export type 神煞 = "咸池" | "驛馬" | "孤辰" | "寡宿" | "將星" | "亡神" | "劫煞" | "災煞" | "白虎" | "華蓋" | "紅鸞" | "天喜";

export const angels: 神煞[] = ["咸池", "驛馬", "將星", "紅鸞", "天喜"];

export const devils: 神煞[] = ["孤辰", "寡宿", "亡神", "劫煞", "災煞", "白虎", "華蓋"];

export const 神煞表: Record<神煞, Record<地支, 地支>> = {
    咸池: {
        [地支.子]: 地支.酉,
        [地支.丑]: 地支.午,
        [地支.寅]: 地支.卯,
        [地支.卯]: 地支.子,
        [地支.辰]: 地支.酉,
        [地支.巳]: 地支.午,
        [地支.午]: 地支.卯,
        [地支.未]: 地支.子,
        [地支.申]: 地支.酉,
        [地支.酉]: 地支.午,
        [地支.戌]: 地支.卯,
        [地支.亥]: 地支.子,
    },
    將星: {
        [地支.子]: 地支.子,
        [地支.丑]: 地支.酉,
        [地支.寅]: 地支.午,
        [地支.卯]: 地支.卯,
        [地支.辰]: 地支.子,
        [地支.巳]: 地支.酉,
        [地支.午]: 地支.午,
        [地支.未]: 地支.卯,
        [地支.申]: 地支.子,
        [地支.酉]: 地支.酉,
        [地支.戌]: 地支.午,
        [地支.亥]: 地支.卯,
    },
    紅鸞: {
        [地支.子]: 地支.卯,
        [地支.丑]: 地支.寅,
        [地支.寅]: 地支.丑,
        [地支.卯]: 地支.子,
        [地支.辰]: 地支.亥,
        [地支.巳]: 地支.戌,
        [地支.午]: 地支.酉,
        [地支.未]: 地支.申,
        [地支.申]: 地支.未,
        [地支.酉]: 地支.午,
        [地支.戌]: 地支.巳,
        [地支.亥]: 地支.辰,
    },
    天喜: {
        [地支.子]: 地支.酉,
        [地支.丑]: 地支.申,
        [地支.寅]: 地支.未,
        [地支.卯]: 地支.午,
        [地支.辰]: 地支.巳,
        [地支.巳]: 地支.辰,
        [地支.午]: 地支.卯,
        [地支.未]: 地支.寅,
        [地支.申]: 地支.丑,
        [地支.酉]: 地支.子,
        [地支.戌]: 地支.亥,
        [地支.亥]: 地支.戌,
    },
    驛馬: {
        [地支.子]: 地支.寅,
        [地支.丑]: 地支.亥,
        [地支.寅]: 地支.申,
        [地支.卯]: 地支.巳,
        [地支.辰]: 地支.寅,
        [地支.巳]: 地支.亥,
        [地支.午]: 地支.申,
        [地支.未]: 地支.巳,
        [地支.申]: 地支.寅,
        [地支.酉]: 地支.亥,
        [地支.戌]: 地支.申,
        [地支.亥]: 地支.巳,
    },
    孤辰: {
        [地支.子]: 地支.寅,
        [地支.丑]: 地支.寅,
        [地支.寅]: 地支.巳,
        [地支.卯]: 地支.巳,
        [地支.辰]: 地支.巳,
        [地支.巳]: 地支.申,
        [地支.午]: 地支.申,
        [地支.未]: 地支.申,
        [地支.申]: 地支.亥,
        [地支.酉]: 地支.亥,
        [地支.戌]: 地支.亥,
        [地支.亥]: 地支.寅,
    },
    寡宿: {
        [地支.子]: 地支.戌,
        [地支.丑]: 地支.戌,
        [地支.寅]: 地支.丑,
        [地支.卯]: 地支.丑,
        [地支.辰]: 地支.丑,
        [地支.巳]: 地支.辰,
        [地支.午]: 地支.辰,
        [地支.未]: 地支.辰,
        [地支.申]: 地支.未,
        [地支.酉]: 地支.未,
        [地支.戌]: 地支.未,
        [地支.亥]: 地支.戌,
    },
    亡神: {
        [地支.子]: 地支.亥,
        [地支.丑]: 地支.申,
        [地支.寅]: 地支.巳,
        [地支.卯]: 地支.寅,
        [地支.辰]: 地支.亥,
        [地支.巳]: 地支.申,
        [地支.午]: 地支.巳,
        [地支.未]: 地支.寅,
        [地支.申]: 地支.亥,
        [地支.酉]: 地支.申,
        [地支.戌]: 地支.巳,
        [地支.亥]: 地支.寅,
    },
    劫煞: {
        [地支.子]: 地支.巳,
        [地支.丑]: 地支.寅,
        [地支.寅]: 地支.亥,
        [地支.卯]: 地支.申,
        [地支.辰]: 地支.巳,
        [地支.巳]: 地支.寅,
        [地支.午]: 地支.亥,
        [地支.未]: 地支.申,
        [地支.申]: 地支.巳,
        [地支.酉]: 地支.寅,
        [地支.戌]: 地支.亥,
        [地支.亥]: 地支.申,
    },
    災煞: {
        [地支.子]: 地支.午,
        [地支.丑]: 地支.卯,
        [地支.寅]: 地支.子,
        [地支.卯]: 地支.酉,
        [地支.辰]: 地支.午,
        [地支.巳]: 地支.卯,
        [地支.午]: 地支.子,
        [地支.未]: 地支.酉,
        [地支.申]: 地支.午,
        [地支.酉]: 地支.卯,
        [地支.戌]: 地支.子,
        [地支.亥]: 地支.酉,
    },
    白虎: {
        [地支.子]: 地支.申,
        [地支.丑]: 地支.酉,
        [地支.寅]: 地支.戌,
        [地支.卯]: 地支.亥,
        [地支.辰]: 地支.子,
        [地支.巳]: 地支.丑,
        [地支.午]: 地支.寅,
        [地支.未]: 地支.卯,
        [地支.申]: 地支.辰,
        [地支.酉]: 地支.巳,
        [地支.戌]: 地支.午,
        [地支.亥]: 地支.未,
    },
    華蓋: {
        [地支.子]: 地支.辰,
        [地支.丑]: 地支.戌,
        [地支.寅]: 地支.丑,
        [地支.卯]: 地支.未,
        [地支.辰]: 地支.辰,
        [地支.巳]: 地支.戌,
        [地支.午]: 地支.丑,
        [地支.未]: 地支.未,
        [地支.申]: 地支.辰,
        [地支.酉]: 地支.戌,
        [地支.戌]: 地支.丑,
        [地支.亥]: 地支.未,
    },
};

export const AngelDevilUtil = Object.freeze({
    getAngelDevil: (日支: 地支, 時支: 地支): 神煞[] => {
        return Object.keys(神煞表).filter(name => 神煞表[name as 神煞][日支] === 時支) as 神煞[];
    },
    isAngel: (神煞: 神煞): boolean => {
        return angels.some(_ => 神煞.startsWith(_));
    },
    isDevil: (神煞: 神煞): boolean => {
        return devils.some(_ => 神煞.startsWith(_));
    },
});
